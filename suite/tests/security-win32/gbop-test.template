plain C call
res=kernel32_base
plain asm call
res=kernel32_base
pretend on stack
#if +PROGRAM_SHEPHERDING : +-security --C --gbop_exclude_list(kernel32.dll!LoadLibraryA) --thin_client
# if : --detect_mode
#  SEC_VIO_AUTO_STOP
#  if : --internal_detach_mask
#   STOP
#  endif
# else
#  SEC_VIO_CONT
# endif
#endif
#if +PROGRAM_SHEPHERDING : +-security --A --gbop_exclude_list(kernel32.dll!LoadLibraryA) --thin_client
# if : --detect_mode
#  SEC_VIO_AUTO_STOP
# else
#  SEC_VIO_CONT
# endif
#endif
exception since not cleaning up stack
res=kernel32_base
pretend on flushed stack
#if +PROGRAM_SHEPHERDING : +-security --A --gbop_exclude_list(kernel32.dll!LoadLibraryA) --thin_client
# if : --detect_mode
#  SEC_VIO_AUTO_STOP
# else
#  SEC_VIO_CONT
# endif
#endif
exception since not cleaning up stack
res=kernel32_base
pretend in image but not after call
#if +PROGRAM_SHEPHERDING : +-security --A --gbop_exclude_list(kernel32.dll!LoadLibraryA) --thin_client
# if : --detect_mode
#  SEC_VIO_AUTO_STOP
# else
#  SEC_VIO_CONT
# endif
#endif
res=kernel32_base
JMP allowed!
done
