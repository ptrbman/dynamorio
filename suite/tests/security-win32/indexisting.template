a
A
z
10
21
21
the answer is 42
calling via PLT-style call
this is a normal function 123456
calling via PLT-style call
// the default value is currently -rct_ind_call 0 
// FIXME: we need support for option parameters when the default changes to 11
// .E expected
#if +PROGRAM_SHEPHERDING : +-security --X --E --low --client --thin_client
# if : --detect_mode
#  SEC_VIO_AUTO_STOP
#  if : --internal_detach_mask
#   STOP
#  endif
# else
#  SEC_VIO_CONT
# endif
#endif
PRECIOUS function shouldn't be reachable! ATTACK SUCCESSFUL!
calling via PLT-style call
// .E expected
#if +PROGRAM_SHEPHERDING : +-security --X --E --low --client --thin_client
# if : --detect_mode
#  SEC_VIO_AUTO_STOP
#  if : --internal_detach_mask
#   STOP
#  endif
# else
#  SEC_VIO_CONT
# endif
#endif
this is another normal function 123456, but shouldn't be called!
calling via PLT-style indirect jmp
this is a normal function 123456
// .C expected
#if +PROGRAM_SHEPHERDING : +-security --no_ret_after_call --X --C --low --client --thin_client
# if : --detect_mode
#  SEC_VIO_AUTO_STOP
#  if : --internal_detach_mask
#   STOP
#  endif
# else
#  SEC_VIO_CONT
# endif
#endif
calling via PLT-style indirect jmp
// .F expected
#if +PROGRAM_SHEPHERDING : +-security --X --F --low --client --thin_client
# if : --detect_mode
#  SEC_VIO_AUTO_STOP
#  if : --internal_detach_mask
#   STOP
#  endif
# else
#  SEC_VIO_CONT
# endif
#endif
PRECIOUS function shouldn't be reachable! ATTACK SUCCESSFUL!
// .C expected
// unless target already cached
#if +PROGRAM_SHEPHERDING : +-security --no_ret_after_call --X --C +-rct_cache_exempt(0) --low --client --thin_client
# if : --detect_mode
#  SEC_VIO_AUTO_STOP
#  if : --internal_detach_mask
#   STOP
#  endif
# else
#  SEC_VIO_CONT
# endif
#endif
done
